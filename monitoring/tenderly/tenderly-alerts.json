{
  "$schema": "https://schema.tenderly.co/alerts/v1",
  "version": "1.0",
  "project": "pil-v2",
  "alerts": [
    {
      "name": "PIL Contract Paused",
      "description": "Alert when any PIL v2 contract is paused",
      "type": "event",
      "enabled": true,
      "severity": "critical",
      "network": ["mainnet", "arbitrum", "optimism", "polygon", "base"],
      "addresses": ["{{PC3}}", "{{PBP}}", "{{EASC}}", "{{CDNA}}", "{{ORCHESTRATOR}}"],
      "eventSignature": "Paused(address)",
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-alerts-critical"
        },
        "pagerduty": {
          "enabled": true,
          "severity": "critical"
        },
        "email": {
          "enabled": true,
          "recipients": ["security@protocol.com"]
        }
      }
    },
    {
      "name": "Timelock Operation Scheduled",
      "description": "Alert when a new timelock operation is scheduled",
      "type": "event",
      "enabled": true,
      "severity": "high",
      "network": ["mainnet", "arbitrum", "optimism", "polygon", "base"],
      "addresses": ["{{TIMELOCK}}"],
      "eventSignature": "CallScheduled(bytes32,uint256,address,uint256,bytes,bytes32,uint256)",
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-governance"
        },
        "email": {
          "enabled": true,
          "recipients": ["governance@protocol.com"]
        }
      }
    },
    {
      "name": "Timelock Operation Executed",
      "description": "Alert when a timelock operation is executed",
      "type": "event",
      "enabled": true,
      "severity": "high",
      "network": ["mainnet", "arbitrum", "optimism", "polygon", "base"],
      "addresses": ["{{TIMELOCK}}"],
      "eventSignature": "CallExecuted(bytes32,uint256,address,uint256,bytes)",
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-governance"
        },
        "email": {
          "enabled": true,
          "recipients": ["governance@protocol.com"]
        }
      }
    },
    {
      "name": "Role Granted",
      "description": "Alert when a role is granted to an address",
      "type": "event",
      "enabled": true,
      "severity": "high",
      "network": ["mainnet", "arbitrum", "optimism", "polygon", "base"],
      "addresses": ["{{PC3}}", "{{PBP}}", "{{EASC}}", "{{CDNA}}", "{{ORCHESTRATOR}}", "{{TIMELOCK}}"],
      "eventSignature": "RoleGranted(bytes32,address,address)",
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-governance"
        },
        "email": {
          "enabled": true,
          "recipients": ["security@protocol.com"]
        }
      }
    },
    {
      "name": "High Value Container Created",
      "description": "Alert when a container with high value is created",
      "type": "event",
      "enabled": true,
      "severity": "medium",
      "network": ["mainnet", "arbitrum", "optimism", "polygon", "base"],
      "addresses": ["{{PC3}}"],
      "eventSignature": "ContainerCreated(bytes32,address,bytes32,bytes32,uint256)",
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-activity"
        }
      }
    },
    {
      "name": "Backend Deactivated",
      "description": "Alert when an execution backend is deactivated",
      "type": "event",
      "enabled": true,
      "severity": "high",
      "network": ["mainnet", "arbitrum", "optimism", "polygon", "base"],
      "addresses": ["{{EASC}}"],
      "eventSignature": "BackendDeactivated(bytes32)",
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-alerts-critical"
        },
        "email": {
          "enabled": true,
          "recipients": ["security@protocol.com"]
        }
      }
    },
    {
      "name": "Policy Deactivated",
      "description": "Alert when a disclosure policy is deactivated",
      "type": "event",
      "enabled": true,
      "severity": "medium",
      "network": ["mainnet", "arbitrum", "optimism", "polygon", "base"],
      "addresses": ["{{PBP}}"],
      "eventSignature": "PolicyDeactivated(bytes32)",
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-governance"
        }
      }
    },
    {
      "name": "High Gas Transaction",
      "description": "Alert when a transaction uses unusually high gas",
      "type": "transaction",
      "enabled": true,
      "severity": "low",
      "network": ["mainnet"],
      "addresses": ["{{PC3}}", "{{PBP}}", "{{EASC}}", "{{CDNA}}", "{{ORCHESTRATOR}}"],
      "conditions": {
        "gasUsed": {
          "gt": 5000000
        }
      },
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-activity"
        }
      }
    },
    {
      "name": "Failed Transaction",
      "description": "Alert when a PIL transaction fails",
      "type": "transaction",
      "enabled": true,
      "severity": "medium",
      "network": ["mainnet", "arbitrum", "optimism", "polygon", "base"],
      "addresses": ["{{PC3}}", "{{PBP}}", "{{EASC}}", "{{CDNA}}", "{{ORCHESTRATOR}}"],
      "conditions": {
        "status": false
      },
      "notifications": {
        "slack": {
          "enabled": true,
          "channel": "#pil-alerts"
        }
      }
    }
  ],
  "actions": [
    {
      "name": "Pause Protocol on Critical Alert",
      "description": "Automatically pause protocol on critical security event",
      "trigger": "PIL Contract Paused",
      "enabled": false,
      "action": {
        "type": "webhook",
        "url": "{{EMERGENCY_WEBHOOK_URL}}",
        "method": "POST",
        "headers": {
          "Authorization": "Bearer {{WEBHOOK_TOKEN}}"
        }
      }
    }
  ]
}
